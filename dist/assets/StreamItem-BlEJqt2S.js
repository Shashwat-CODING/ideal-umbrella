import{f as W,a as n,a5 as q,t as u,U as I,F as f,p as P,s as z,M as F,R as M,V as j,G as D,u as x,e as Q,i as c,c as U,S as V,b as y,X,r as B,z as G,P as L,aa as N,d as H}from"./index-BIf49YX_.js";var J=u("<img crossorigin=anonymous>"),K=u("<p class=duration>"),O=u("<a class=streamItem><span></span><div class=metadata><p class=title></p><div class=avu><p class=author></p><p class=viewsXuploaded>"),Y=u("<i aria-label=Drag class=ri-draggable>"),Z=u("<i aria-label=More class=ri-more-2-fill>");function te(e){const[g,p]=W("");let m;function k(i){const d=i.target,v=g();if(d.naturalWidth!==120){m.classList.remove("ravel");return}v.includes("webp")?p(v.replace(".webp",".jpg").replace("vi_webp","vi")):e.context&&B(e.context?.id,[e.id])}function A(){const i=g();p(i.includes("vi_webp")?i.replace(".webp",".jpg").replace("vi_webp","vi"):"/logo192.png"),m.classList.remove("ravel")}const h=e.context?.id.startsWith("Album"),C=e.context?.id?.startsWith("Artist - "),E=e.author?.endsWith("- Topic");return n.loadImage&&!h&&p(q(e.img||e.id,"mq",e.context?.id==="favorites"||C||e.context?.src==="queue"&&E)),(()=>{var i=O(),d=i.firstChild,v=d.nextSibling,S=v.firstChild,R=S.nextSibling,_=R.firstChild,T=_.nextSibling;i.$$click=t=>{if(t.preventDefault(),e.removeMode){I("list",o=>o.filter(r=>r.id!==e.id));return}if(e.mark?.mode()){e.mark.set(e.id);return}if(t.target.classList.contains("ri-more-2-fill")){x("actionsMenu",{id:e.id,title:e.title,author:e.author,duration:e.duration,authorId:e.authorId});const{albumId:o}=e;Q.actionsMenu?.albumId&&x("actionsMenu","albumId",void 0),o&&x("actionsMenu","albumId",o)}else{if(f("stream",{id:e.id,title:e.title,author:e.author||"",duration:e.duration,authorId:e.authorId||""}),e.albumId?f("stream","albumId",e.albumId):P.stream.albumId&&f("stream","albumId",void 0),e.context&&f("context",{id:e.context.id,src:e.context.src}),(matchMedia("(orientation:portrait)").matches||n.landscapeSections==="1")&&(z("player","state",!!n.watchMode),n.watchMode&&F.player.ref?.scrollIntoView()),n.enqueueRelatedStreams&&(e.context?.src==="collection"||e.context?.src==="playlists"&&M.name.startsWith("Album - "))&&e.context?.id!=="history"){const r=e.context.src==="collection"?j(e.context.id):M.list,l=r.findIndex(s=>s.id===e.id);if(l!==-1){const s=[];let a=l-1,b=l+1;const $=r.length;for(;a>=0||b<$;)b<$&&s.push(r[b++]),a>=0&&s.push(r[a--]);I("list",s)}}if(D(e.id),e.context?.src==="queue"){const r=parseInt(e.context.id,10);I("list",l=>l.filter((s,a)=>a!==r))}}};var w=m;return typeof w=="function"?G(w,i):m=i,c(d,U(V,{get when(){return!h&&n.loadImage},get fallback(){return e.duration},get children(){return[(()=>{var t=J();return t.addEventListener("load",k),t.addEventListener("error",A),y(()=>L(t,"src",g())),t})(),(()=>{var t=K();return c(t,()=>e.duration),t})()]}})),c(S,()=>e.title),c(_,()=>e.author?.replace(" - Topic","")),c(T,()=>(e.views||"")+(e.uploaded?" â€¢ "+e.uploaded.replace("Streamed ",""):"")),c(i,(()=>{var t=X(()=>!!e.draggable);return()=>t()?Y():Z()})(),null),y(t=>{var o=!!(n.loadImage&&!h),r=!!e.mark?.get(e.id),l=!!e.removeMode,s=N("/watch?v="+e.id);return o!==t.e&&i.classList.toggle("ravel",t.e=o),r!==t.t&&i.classList.toggle("marked",t.t=r),l!==t.a&&i.classList.toggle("delete",t.a=l),s!==t.o&&L(i,"href",t.o=s),t},{e:void 0,t:void 0,a:void 0,o:void 0}),i})()}H(["click"]);export{te as S};
