import{p as l,aj as u,h as a}from"./index-BIf49YX_.js";import{g as y,u as f}from"./hub-Co9BINa5.js";function p(s,d){if(s!==l.stream.id)return;const e=y();e.discovery||(e.discovery=[]),d?.forEach(o=>{if(o.type!=="stream"||o.duration<100||o.duration>3e3)return;const i=o.url.slice(9),t=e.discovery.find(n=>n.id===i);t?t.frequency++:e.discovery.push({id:i,title:o.title,author:o.uploaderName,duration:u(o.duration),authorId:o.uploaderUrl.slice(9),frequency:1})});for(let o=e.discovery.length-1;o>0;o--){const i=Math.floor(Math.random()*(o+1));[e.discovery[o],e.discovery[i]]=[e.discovery[i],e.discovery[o]]}const c=a("history");e.discovery=e.discovery.filter(o=>!c.includes(o.id));let r=e.discovery.length;for(;r>256;){const o=Math.floor(Math.random()*r);e.discovery.splice(o,1),r--}f(e)}export{p as default};
