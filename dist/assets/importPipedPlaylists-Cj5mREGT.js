import{m as t,u as a,T as k,aj as b,j as g}from"./index-BIf49YX_.js";async function y(){const n=prompt(t("piped_enter_auth"),"https://pipedapi.kavin.rocks");if(!n)return;const r=prompt(t("piped_enter_username"));if(!r)return;const c=prompt(t("piped_enter_password"));if(!c)return;const s=await fetch(n+"/login",{method:"POST",body:JSON.stringify({username:r,password:c})}).then(e=>e.json()).catch(e=>a("snackbar",t("piped_failed_login",e)));if(!s){a("snackbar",t("piped_failed_token"));return}a("snackbar",t("piped_success_logged"));const p=await fetch(n+"/user/playlists",{headers:{Authorization:s.token}}).then(e=>e.json()).catch(e=>a("snackbar",t("piped_failed_find",e)));if(p.length)a("snackbar",t("piped_success_fetched"));else return;await Promise.all(p.map(e=>fetch(n+"/playlists/"+e.id).then(o=>o.json()).then(o=>{const{name:d,relatedStreams:l}=o;k(d);const u=l.filter((i,h,_,f,m)=>i.length===20&&h&&_&&f>0&&m).map(i=>({id:i.url.slice(9),title:i.title,author:i.uploaderName,duration:b(i.duration),authorId:i.uploaderUrl.slice(9)}));g(d,u)}))).then(()=>{a("snackbar",t("piped_success_imported")),document.getElementById("r.collections")?.click()}).catch(e=>{a("snackbar",t("piped_failed_imported",e))}),fetch(n+"/logout",{method:"POST",headers:{Authorization:s.token}}).then(e=>{a("snackbar",t(e.ok?"piped_success_auth":"piped_failed_auth"))})}export{y as default};
