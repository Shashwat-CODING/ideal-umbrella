import{w as l,a0 as m,u as p,aj as g,J as w,a1 as I}from"./index-BIf49YX_.js";async function A(s){l("isLoading",!0);const r="https://ytify-backend.vercel.app",i="/api/feed/channels=",d=m("channels").map(n=>n.id);return fetch(r+i+d.join(",")+s).then(n=>n.json()).then(n=>{if(!n.length)throw new Error(n.message);return n?.filter(c=>c.duration>90)}).catch(n=>(p("snackbar",n.message||"Error"),[])).finally(()=>{l("isLoading",!0)})}const y={discovery:[],userArtists:[],relatedPlaylists:[],relatedArtists:[],subfeed:[]};function S(){const s=localStorage.getItem("hub");return s?JSON.parse(s):y}function j(s){localStorage.setItem("hub",JSON.stringify(s))}function u(s,r){const i=S();i[s]=r,j(i)}async function O(s){return A(s).then(r=>{const i=r.map(o=>({...o,duration:g(o.duration)}));u("subfeed",i)})}async function v(){const s=Object.values(w()),r={};s.filter(t=>t.author.endsWith(" - Topic")).forEach(t=>{r[t.authorId]=(r[t.authorId]||0)+1});const o=Object.entries(r).filter(t=>t[1]>3).sort(([,t],[,e])=>e-t).map(([t])=>t);if(o.length<2){u("relatedArtists",[]),u("relatedPlaylists",[]),u("userArtists",[]);return}const d=await fetch(`https://ytify-zeta.vercel.app/api/artists?id=${o.join(",")}`).then(t=>{if(!t.ok)throw new Error("Network response was not ok");return t.json()}).catch(t=>(console.error("Error fetching multiple artists:",t),[])),n={},c={};for(const t of d)t?.recommendedArtists&&t.recommendedArtists.forEach(e=>{if(e.browseId&&e.name&&e.thumbnail){const a=e.browseId;o.includes(a)||(a in n?n[a].count++:n[a]={id:e.browseId,name:e.name,thumbnail:e.thumbnail,count:1})}}),t?.featuredOnPlaylists&&t.featuredOnPlaylists.forEach(e=>{if(e.browseId&&e.title&&e.thumbnail){const a=e.browseId;a in c?c[a].count++:c[a]={id:e.browseId.startsWith("VL")?e.browseId.substring(2):e.browseId,name:e.title,thumbnail:e.thumbnail,uploader:t.artistName,count:1}}});const f=Object.values(c).filter(t=>t.count&&t.count>2).sort((t,e)=>e.count-t.count).map(t=>(delete t.count,t)),h=Object.values(n).filter(t=>t.count&&t.count>2).sort((t,e)=>e.count-t.count).map(t=>(delete t.count,t)),b=d.map(t=>({id:o[d.indexOf(t)],name:t.artistName,thumbnail:I(t.thumbnail)})).filter(t=>t.id&&t.name&&t.thumbnail);u("relatedArtists",h),u("relatedPlaylists",f),u("userArtists",b)}export{O as a,v as b,u as c,S as g,j as u};
